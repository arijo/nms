define([
	'jquery',
	'underscore',
	'backbonejs',
	'raphael',

	'shared/nms/utils/random' ],
       
	function( $, _, Backbone, 
		  
		  Raphael, 

		  Random ) {

			// MEDIA LIFE CYCLE ILLUSTRATION VIEW
			var LoginIllustration = Backbone.View.extend({

				// LAYOUT DEFAULTS
				layoutDefaults: {
					selector:     '#grid .screen.login .illustrations',
					paper:        null,
					width:        null,
					height:       null,
					loopInterval: 500,
					intervalID:   null
				},

				// COLOR DEFAULTS
				colorDefaults: {
					background:  '#393939',
					foreground1: '#f45553',
					foreground2: '#dc4f85',
					foreground3: '#f963df',
					type1:       '#ffffff',
					type2:       '#ffffff',
					dots:        ['#f45553', '#ffffff']
				},
			
				// KEEP TRACK OF THE DOTS
				dots: {
					set:        null,
					count:      60,
					minSize:    4,
					maxSize:    15,
					minOpacity: 30,
					maxOpacity: 70
				},

				// HIGHWAY IMAGE PATHS
				highway: {
					set:         null,
					outline:     null,
					outlinePath: 'M1012.571,362.229c-5.18,0-9.395,4.202-9.395,9.368c0,0.063,0.008,0.124,0.01,0.188l-99.511,12.671l-2.489-31.987c1.814-0.286,3.542-0.972,5.076-2.028c2.714-1.872,4.536-4.689,5.127-7.936c0.591-3.239-0.115-6.512-1.988-9.213c-0.108-0.155-0.234-0.293-0.349-0.442l243.863-218.386c1.479,1.032,3.499,1.111,5.072,0.027c2.021-1.392,2.526-4.155,1.131-6.169c-1.397-2.014-4.168-2.518-6.188-1.126c-1.895,1.306-2.435,3.808-1.348,5.776l-243.868,218.39c-2.273-2.142-5.298-3.383-8.497-3.383c-2.515,0-4.938,0.755-7.01,2.183c-2.713,1.87-4.534,4.687-5.126,7.932c-0.591,3.24,0.114,6.513,1.988,9.216c2.295,3.31,6.076,5.289,10.122,5.309l2.498,32.091l-54.523,6.943l-71.767-68.057c1.927-2.51,3.086-5.636,3.086-9.033c0-8.219-6.706-14.905-14.949-14.905c-7.603,0-13.885,5.692-14.817,13.025l-256.527-68.438c0.124-0.686,0.199-1.389,0.199-2.11c0-6.589-5.375-11.95-11.983-11.95c-6.608,0-11.984,5.361-11.984,11.95c0,6.589,5.376,11.95,11.984,11.95c1.229,0,2.416-0.187,3.534-0.531l62.366,154.435l-26.914,24.865L250.462,280.128c0.433-1.255,0.68-2.596,0.68-3.996c0-6.795-5.544-12.324-12.359-12.324s-12.359,5.528-12.359,12.324c0,1.822,0.409,3.547,1.124,5.105l-109.256,81.311c-2.722-4.26-7.49-7.1-12.921-7.1c-8.45,0-15.324,6.854-15.324,15.28s6.875,15.281,15.324,15.281s15.324-6.855,15.324-15.281c0-2.291-0.522-4.458-1.433-6.41l109.265-81.317c2.222,3.288,5.99,5.455,10.256,5.455c4.696,0,8.788-2.626,10.879-6.483l268.19,152.304l-54.21,50.085c-0.843-0.65-1.896-1.029-3.019-1.029c-0.423,0-0.848,0.056-1.26,0.164c-1.279,0.334-2.352,1.146-3.018,2.287c-0.262,0.448-0.426,0.93-0.536,1.421L334.971,460.36c0.029-0.59-0.029-1.193-0.188-1.794c-0.832-3.157-4.073-5.045-7.241-4.217c-3.167,0.829-5.061,4.062-4.229,7.222c0.832,3.157,4.073,5.046,7.241,4.216c1.87-0.489,3.29-1.82,3.973-3.476l121.263,26.939c0.019,0.09,0.021,0.181,0.044,0.271c0.571,2.168,2.538,3.682,4.783,3.682c0.423,0,0.847-0.055,1.259-0.163c1.28-0.335,2.352-1.148,3.018-2.289c0.664-1.138,0.845-2.465,0.51-3.737c-0.106-0.402-0.274-0.771-0.469-1.123l54.743-50.576l42.797,24.304c-0.343,0.852-0.537,1.779-0.537,2.754c0,4.082,3.317,7.391,7.41,7.391c4.094,0,7.411-3.309,7.411-7.391s-3.317-7.391-7.411-7.391c-0.626,0-1.231,0.086-1.812,0.232l-18.856-46.694l81.8-75.574c1.133,0.962,2.584,1.543,4.151,1.543c0.549,0,1.1-0.071,1.637-0.212c1.665-0.436,3.058-1.493,3.924-2.977c0.863-1.478,1.098-3.201,0.662-4.854c-0.743-2.816-3.299-4.784-6.216-4.784c-0.549,0-1.1,0.071-1.636,0.212c-1.664,0.436-3.056,1.492-3.922,2.975c-0.863,1.478-1.099,3.202-0.663,4.855c0.164,0.624,0.43,1.197,0.756,1.726l-81.294,75.108l-62.086-153.741c2.716-1.37,4.835-3.737,5.878-6.62l256.801,68.509l0.136-0.509c-0.003,0.13-0.02,0.256-0.02,0.386c0,8.218,6.706,14.904,14.949,14.904c4.115,0,7.847-1.667,10.552-4.358l70.516,66.87L721.74,407.623c-0.629-1.688-2.245-2.897-4.157-2.897c-2.456,0-4.447,1.986-4.447,4.436s1.991,4.435,4.447,4.435c2.302,0,4.174-1.751,4.402-3.986l124.494-15.854l51.73,49.056c-1.718,2.117-2.752,4.808-2.752,7.736c0,6.796,5.544,12.324,12.359,12.324c6.814,0,12.358-5.528,12.358-12.324c0-6.781-5.521-12.298-12.315-12.322l-4.029-51.772l99.61-12.685c0.986,4.121,4.701,7.198,9.13,7.198c5.18,0,9.395-4.203,9.395-9.369S1017.751,362.229,1012.571,362.229z M889.892,346.739c-1.721-2.482-2.369-5.489-1.826-8.466c0.544-2.981,2.217-5.569,4.71-7.287c1.904-1.312,4.131-2.007,6.442-2.007c3.742,0,7.241,1.825,9.361,4.883c1.721,2.481,2.369,5.486,1.826,8.463c-0.544,2.982-2.217,5.572-4.711,7.291c-1.904,1.312-4.131,2.006-6.442,2.006C895.511,351.622,892.012,349.797,889.892,346.739z M119.695,370.729c0,7.875-6.426,14.281-14.324,14.281c-7.898,0-14.324-6.406-14.324-14.281c0-7.874,6.426-14.28,14.324-14.28C113.269,356.448,119.695,362.854,119.695,370.729z M238.783,287.456c-6.264,0-11.359-5.08-11.359-11.324s5.096-11.324,11.359-11.324c6.263,0,11.359,5.08,11.359,11.324S245.046,287.456,238.783,287.456z M464.03,490.247c-0.532,0.91-1.387,1.559-2.408,1.826c-0.33,0.086-0.668,0.13-1.006,0.13c-1.791,0-3.36-1.207-3.816-2.937c-0.267-1.014-0.123-2.071,0.407-2.978c0.532-0.91,1.387-1.559,2.408-1.825c0.331-0.087,0.669-0.131,1.007-0.131c1.79,0,3.358,1.207,3.813,2.937C464.704,488.282,464.56,489.34,464.03,490.247z M629.942,325.352c0.731-1.252,1.907-2.144,3.312-2.512c0.454-0.118,0.919-0.179,1.383-0.179c2.463,0,4.622,1.661,5.249,4.039c0.367,1.395,0.169,2.849-0.559,4.096c-0.731,1.252-1.908,2.145-3.314,2.514c-0.454,0.118-0.919,0.179-1.383,0.179c-2.463,0-4.621-1.661-5.247-4.039C629.015,328.054,629.214,326.599,629.942,325.352z M565.679,455.956c-0.86,0.491-1.609,1.148-2.209,1.929l-42.25-23.995l25.889-23.919L565.679,455.956z M480.407,253.835c-6.47,0-11.734-5.249-11.734-11.7c0-6.451,5.264-11.7,11.734-11.7c6.47,0,11.733,5.249,11.733,11.7C492.141,248.586,486.877,253.835,480.407,253.835z M763.536,329.217c-8.105,0-14.699-6.574-14.699-14.654c0-0.536,0.033-1.063,0.09-1.584l0.06-0.225l-0.024-0.007c0.901-7.226,7.087-12.84,14.574-12.84c8.105,0,14.699,6.574,14.699,14.655C778.235,322.643,771.641,329.217,763.536,329.217z M919.175,450.548c0,6.244-5.095,11.324-11.358,11.324c-6.264,0-11.359-5.08-11.359-11.324s5.096-11.324,11.359-11.324C914.08,439.224,919.175,444.304,919.175,450.548z M905.867,438.393c-2.387,0.38-4.544,1.438-6.271,2.979l-50.555-47.941l52.803-6.724L905.867,438.393z M1012.571,379.967c-4.629,0-8.395-3.754-8.395-8.369c0-4.614,3.766-8.368,8.395-8.368s8.395,3.754,8.395,8.368C1020.966,376.213,1017.2,379.967,1012.571,379.967z'
				},

				transitionIntoBegin: function() {

					this.start();
				},

				transitionIntoComplete: function() {

					this._animateTextContent();
				},

				transitionOffBegin: function() {


				},

				transitionOffComplete: function() {

					this.stop();
				},

				start: function() {

					// Set up fake login screen - TEMPORARY - this should move somewhere else (Alex?)
					var formSelector = '.login form';
					var messageSelector = '.login form .forgot';
					$(formSelector + ' input').focus(function(){
						$(messageSelector).text('');
					});
					$(formSelector + ' .button').click(function(){
						$(messageSelector).text('Invalid login.');
					});


					var dots = this.dots, 
					    highway =   this.highway,
					    layout = this.layoutDefaults,
					    colors = this.colorDefaults;

					layout.width = $(window).width();	
					layout.height = $(window).height();

					layout.paper = Raphael(
						$(layout.selector)[0],
						layout.width,
						layout.height
					);

					dots.set = layout.paper.set()

					highway.outline = layout.paper.path(highway.outlinePath).attr({
							'stroke-width':      5,
							'stroke-miterlimit': 10
						});
					highway.set = layout.paper.set();
					highway.set.push(highway.outline);
					highway.set
						.attr({
							opacity: '0.20'
						})
						.transform('T300-100,10R-30S1,1');
					highway.set.animate({
						transform: 'T300-150,10R-120S5,5'
					}, 300000, 'linear', function(){
						// call back
					});

					// START THE ANIMATION LOOP
					this.clock = setInterval( 
						$.proxy( this.paint, this),
						layout.loopInterval
					);
				},

				// CALLED ONCE IN EACH ANIMATION LOOP
				paint: function() {

				       //console.log('paint');
				},	

				stop: function() {
					var layout = this.layoutDefaults;
					clearInterval( this.clock);
					layout.paper.clear();
				},

				/*transitionComplete: function() {
					this._animateTextContent();
				},*/

				resize: function() {
					this.stop();
					this.start();
				},

				getBgColor: function() {
					return this.colorDefaults.background;
				},

				_animateTextContent: function() {
					//console.log('Animating MediaLifeCycle text');

				}
			});

			return LoginIllustration;
});
